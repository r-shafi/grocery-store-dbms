{% extends 'parent.html' %} {% block title %}
<title>Admin Dashboard</title>
{% endblock %} {% block body %}
<div class="w-full flex flex-col gap-4 p-4">
  <h1 class="text-3xl font-bold text-center">Admin Dashboard</h1>

  <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
    <div class="bg-white shadow-md rounded-lg p-4 flex flex-col items-center">
      <h5 class="text-lg font-semibold">Total Products</h5>
      <h3 class="text-2xl">{{ total_products }}</h3>
    </div>
    <div class="bg-white shadow-md rounded-lg p-4 flex flex-col items-center">
      <h5 class="text-lg font-semibold">Registered Users</h5>
      <h3 class="text-2xl">{{ total_users }}</h3>
    </div>
    <div class="bg-white shadow-md rounded-lg p-4 flex flex-col items-center">
      <h5 class="text-lg font-semibold">Total Orders</h5>
      <h3 class="text-2xl">{{ total_orders }}</h3>
    </div>
    <div class="bg-white shadow-md rounded-lg p-4 flex flex-col items-center">
      <h5 class="text-lg font-semibold">Total Revenue</h5>
      <h3 class="text-2xl">৳{{ "%.2f"|format(total_revenue) }}</h3>
    </div>
  </div>

  <div class="bg-white shadow-md rounded-lg p-4">
    <h2 class="text-xl font-bold">Product Management</h2>
    <div class="mb-4">
      <a
        href="/admin/product"
        class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600"
        >Add New Product</a
      >
      <a
        href="/admin/category"
        class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600"
        >Manage Categories</a
      >
    </div>
    <div class="overflow-x-auto">
      <table class="min-w-full border-collapse border border-gray-300">
        <thead>
          <tr class="border-b">
            <th class="px-6 py-3 text-left border">Name</th>
            <th class="px-6 py-3 text-left border">Category</th>
            <th class="px-6 py-3 text-left border">Price</th>
            <th class="px-6 py-3 text-left border">Quantity</th>
            <th class="px-6 py-3 border">Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for product in products %}
          <tr class="border-b">
            <td class="px-6 py-4 border">{{ product.name }}</td>
            <td class="px-6 py-4 border">
              {{ product.category.name if product.category else 'Uncategorized'
              }}
            </td>
            <td class="px-6 py-4 border">
              ৳{{ "%.2f"|format(product.price) }}
            </td>
            <td class="px-6 py-4 border">{{ product.quantity }}</td>
            <td class="px-6 py-4 border">
              <div role="group" class="flex space-x-2">
                <a
                  href="/admin/product/{{ product.id }}"
                  class="text-blue-500 hover:underline"
                  >Edit</a
                >
                <form
                  action="/admin/delete_product/{{ product.id }}"
                  method="POST"
                >
                  <button
                    type="submit"
                    class="text-red-500 hover:underline"
                    onclick="return confirm('Are you sure?')"
                  >
                    Delete
                  </button>
                </form>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="bg-white shadow-md rounded-lg p-4 mt-4">
    <h2 class="text-xl font-bold">User Management</h2>
    <div class="mb-4">
      <a
        href="/admin/user"
        class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600"
        >Add New User</a
      >
    </div>
    <div class="overflow-x-auto">
      <table class="min-w-full border-collapse border border-gray-300">
        <thead>
          <tr class="border-b">
            <th class="px-6 py-3 text-left border">Name</th>
            <th class="px-6 py-3 text-left border">Email</th>
            <th class="px-6 py-3 text-left border">Role</th>
            <th class="px-6 py-3 border">Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for user in users %}
          <tr class="border-b">
            <td class="px-6 py-4 border">{{ user.name }}</td>
            <td class="px-6 py-4 border">{{ user.email }}</td>
            <td class="px-6 py-4 border">
              {{ 'Admin' if user.is_admin else 'User' }}
            </td>
            <td class="px-6 py-4 border">
              <div role="group" class="flex space-x-2">
                <a
                  href="/admin/user/{{ user.id }}"
                  class="text-blue-500 hover:underline"
                  >Edit</a
                >
                {% if not user.is_admin %}
                <form action="/admin/delete_user/{{ user.id }}" method="POST">
                  <button
                    type="submit"
                    class="text-red-500 hover:underline"
                    onclick="return confirm('Are you sure?')"
                  >
                    Delete
                  </button>
                </form>
                {% endif %}
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="bg-white shadow-md rounded-lg p-4 mt-4">
    <h2 class="text-xl font-bold">Recent Orders</h2>
    <div class="mb-4">
      <a
        href="/admin/orders"
        class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600"
        >View All Orders</a
      >
    </div>
    <div class="overflow-x-auto">
      <table class="min-w-full border-collapse border border-gray-300">
        <thead>
          <tr class="border-b">
            <th class="px-6 py-3 text-left border">Order ID</th>
            <th class="px-6 py-3 text-left border">User</th>
            <th class="px-6 py-3 text-left border">Total Price</th>
            <th class="px-6 py-3 text-left border">Status</th>
            <th class="px-6 py-3 text-left border">Date</th>
            <th class="px-6 py-3 border">Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for order in recent_orders %}
          <tr class="border-b">
            <td class="px-6 py-4 border">{{ order.id }}</td>
            <td class="px-6 py-4 border">{{ order.user.name }}</td>
            <td class="px-6 py-4 border">
              ৳{{ "%.2f"|format(order.total_price) }}
            </td>
            <td class="px-6 py-4 border">{{ order.status }}</td>
            <td class="px-6 py-4 border">
              {{ order.created_at.strftime('%Y-%m-%d %H:%M') }}
            </td>
            <td class="px-6 py-4 border">
              <a
                href="/admin/order_details/{{ order.id }}"
                class="text-blue-500 hover:underline"
                >Details</a
              >
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %} {% block scripts %}
<script>
  function confirmAction(message) {
    return confirm(message);
  }
</script>
{% endblock %}
