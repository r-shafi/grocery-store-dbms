{% extends 'parent.html' %} {% block title %}<title>Admin Dashboard</title>{%
endblock %} {% block body %}
<div>
  <h1>Admin Dashboard</h1>

  <div>
    <!-- Quick Stats Section -->
    <div>
      <div>
        <div>
          <h5>Quick Statistics</h5>
        </div>
        <div>
          <div>
            <div>
              <div>
                <div>
                  <h3>{{ total_products }}</h3>
                  <p>Total Products</p>
                </div>
              </div>
            </div>
            <div>
              <div>
                <div>
                  <h3>{{ total_users }}</h3>
                  <p>Registered Users</p>
                </div>
              </div>
            </div>
            <div>
              <div>
                <div>
                  <h3>{{ total_orders }}</h3>
                  <p>Total Orders</p>
                </div>
              </div>
            </div>
            <div>
              <div>
                <div>
                  <h3>{{ total_revenue }}</h3>
                  <p>Total Revenue</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Product Management -->
    <div>
      <div>
        <div>
          Product Management
          <div>
            <a href="/admin/product"> Add New Product </a>
            <a href="/admin/category"> Manage Categories </a>
          </div>
        </div>
        <div>
          <table>
            <thead>
              <tr>
                <th>Name</th>
                <th>Category</th>
                <th>Price</th>
                <th>Quantity</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              {% for product in products %}
              <tr>
                <td>{{ product.name }}</td>
                <td>
                  {{ product.category.name if product.category else
                  'Uncategorized' }}
                </td>
                <td>${{ "%.2f"|format(product.price) }}</td>
                <td>{{ product.quantity }}</td>
                <td>
                  <div role="group">
                    <a href="/admin/product/{{ product.id }}"> Edit </a>
                    <form
                      action="/admin/delete_product/{{ product.id }}"
                      method="POST"
                    >
                      <button
                        type="submit"
                        onclick="return confirm('Are you sure?')"
                      >
                        Delete
                      </button>
                    </form>
                  </div>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- User Management -->
    <div>
      <div>
        <div>
          User Management
          <a href="/admin/user"> Add New User </a>
        </div>
        <div>
          <table>
            <thead>
              <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Role</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              {% for user in users %}
              <tr>
                <td>{{ user.name }}</td>
                <td>{{ user.email }}</td>
                <td>
                  <span> {{ 'Admin' if user.is_admin else 'User' }} </span>
                </td>
                <td>
                  <div role="group">
                    <a href="/admin/user/{{ user.id }}">Edit</a>
                    {% if not user.is_admin %}
                    <form
                      action="/admin/delete_user/{{ user.id }}"
                      method="POST"
                    >
                      <button
                        type="submit"
                        onclick="return confirm('Are you sure?')"
                      >
                        Delete
                      </button>
                    </form>
                    {% endif %}
                  </div>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Order Management -->
    <div>
      <div>
        <div>
          Recent Orders
          <a href="/admin/orders">View All Orders</a>
        </div>
        <div>
          <table>
            <thead>
              <tr>
                <th>Order ID</th>
                <th>User</th>
                <th>Total Price</th>
                <th>Status</th>
                <th>Date</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              {% for order in recent_orders %}
              <tr>
                <td>{{ order.id }}</td>
                <td>{{ order.user.name }}</td>
                <td>${{ "%.2f"|format(order.total_price) }}</td>
                <td>
                  <span> {{ order.status }} </span>
                </td>
                <td>{{ order.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
                <td>
                  <a href="/admin/order_details/{{ order.id }}">Details</a>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block scripts %}
<script>
  function confirmAction(message) {
    return confirm(message);
  }
</script>
{% endblock %}
